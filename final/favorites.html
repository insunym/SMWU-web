<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="basic.css">
    <link rel="stylesheet" href="navibar.css">
    <title>급하송</title>
    <style>
      .container { padding: 24px; max-width: 800px; margin: auto; }
      .search { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 20px; }
      .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 20px; }
      .card { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
      .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
      .heart { font-size: 20px; color: #ccc; cursor: pointer; }
      .heart.active { color: #ff6b6b; }
      .station-img { width: 100%; height: 120px; object-fit: cover; border-radius: 4px; margin-bottom: 12px; display: none; }
      .rating { font-size: 14px; color: #666; }
      .empty { text-align: center; color: #999; margin-top: 60px; }
  </style>
</head>
<body>
<div class="main-container">
  <!-- 탭 메뉴 -->
  <div class="tabs">
    <div class="tab" onclick="location.href='section-select.html'">지도 보기</div>
    <div class="tab" onclick="location.href='review.html'" >역 후기</div>
    <div class="tab active" onclick="location.href='favorites.html'">즐겨찾는 역</div>
    <div class="tab" onclick="location.href='profile.html'">나의 정보</div>
  </div>

  <div class="container">
    <!-- 검색 창 -->
    <input id="searchInput" class="search" placeholder="역명을 검색하세요...">

    <!-- 역 카드 그리드 -->
    <div id="stationGrid" class="grid">
      <!-- 각 역 카드 템플릿 -->
      <div class="card" data-station="대곡">
        <div class="header">
          <span>대곡역</span>
          <span class="heart" onclick="toggleFavorite('대곡', this)">♡</span>
        </div>
        <img src="대곡역.jpg" alt="대곡역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-대곡">0.0</span></div>
      </div>
      <!-- 디지털미디어시티역 -->
      <div class="card" data-station="디지털미디어시티">
        <div class="header">
          <span>디지털미디어시티역</span>
          <span class="heart" onclick="toggleFavorite('디지털미디어시티', this)">♡</span>
        </div>
        <img src="디지털미디어시티역.jpg" alt="디지털미디어시티역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-디지털미디어시티">0.0</span></div>
      </div>
      <!-- 홍대입구역 -->
      <div class="card" data-station="홍대입구">
        <div class="header">
          <span>홍대입구역</span>
          <span class="heart" onclick="toggleFavorite('홍대입구', this)">♡</span>
        </div>
        <img src="홍대입구역.jpg" alt="홍대입구역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-홍대입구">0.0</span></div>
      </div>
      <!-- 공덕역 -->
      <div class="card" data-station="공덕">
        <div class="header">
          <span>공덕역</span>
          <span class="heart" onclick="toggleFavorite('공덕', this)">♡</span>
        </div>
        <img src="공덕역.jpg" alt="공덕역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-공덕">0.0</span></div>
      </div>
      <!-- 용산역 -->
      <div class="card" data-station="용산">
        <div class="header">
          <span>용산역</span>
          <span class="heart" onclick="toggleFavorite('용산', this)">♡</span>
        </div>
        <img src="용산역.jpg" alt="용산역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-용산">0.0</span></div>
      </div>
      <!-- 이촌역 -->
      <div class="card" data-station="이촌">
        <div class="header">
          <span>이촌역</span>
          <span class="heart" onclick="toggleFavorite('이촌', this)">♡</span>
        </div>
        <img src="이촌역.jpg" alt="이촌역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-이촌">0.0</span></div>
      </div>
      <!-- 서빙고역 -->
      <div class="card" data-station="서빙고">
        <div class="header">
          <span>서빙고역</span>
          <span class="heart" onclick="toggleFavorite('서빙고', this)">♡</span>
        </div>
        <img src="서빙고역.jpg" alt="서빙고역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-서빙고">0.0</span></div>
      </div>
      <!-- 옥수역 -->
      <div class="card" data-station="옥수">
        <div class="header">
          <span>옥수역</span>
          <span class="heart" onclick="toggleFavorite('옥수', this)">♡</span>
        </div>
        <img src="옥수역.jpg" alt="옥수역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-옥수">0.0</span></div>
      </div>
      <!-- 응봉역 -->
      <div class="card" data-station="응봉">
        <div class="header">
          <span>응봉역</span>
          <span class="heart" onclick="toggleFavorite('응봉', this)">♡</span>
        </div>
        <img src="응봉역.jpg" alt="응봉역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-응봉">0.0</span></div>
      </div>
      <!-- 왕십리역 -->
      <div class="card" data-station="왕십리">
        <div class="header">
          <span>왕십리역</span>
          <span class="heart" onclick="toggleFavorite('왕십리', this)">♡</span>
        </div>
        <img src="왕십리역.jpg" alt="왕십리역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-왕십리">0.0</span></div>
      </div>
      <!-- 청량리역 -->
      <div class="card" data-station="청량리">
        <div class="header">
          <span>청량리역</span>
          <span class="heart" onclick="toggleFavorite('청량리', this)">♡</span>
        </div>
        <img src="청량리역.jpg" alt="청량리역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-청량리">0.0</span></div>
      </div>
      <!-- 상봉역 -->
      <div class="card" data-station="상봉">
        <div class="header">
          <span>상봉역</span>
          <span class="heart" onclick="toggleFavorite('상봉', this)">♡</span>
        </div>
        <img src="상봉역.jpg" alt="상봉역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-상봉">0.0</span></div>
      </div>
      <!-- 망우역 -->
      <div class="card" data-station="망우">
        <div class="header">
          <span>망우역</span>
          <span class="heart" onclick="toggleFavorite('망우', this)">♡</span>
        </div>
        <img src="망우역.jpg" alt="망우역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-망우">0.0</span></div>
      </div>
      <!-- 구리역 -->
      <div class="card" data-station="구리">
        <div class="header">
          <span>구리역</span>
          <span class="heart" onclick="toggleFavorite('구리', this)">♡</span>
        </div>
        <img src="구리역.jpg" alt="구리역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-구리">0.0</span></div>
      </div>
      <!-- 지평역 -->
      <div class="card" data-station="지평">
        <div class="header">
          <span>지평역</span>
          <span class="heart" onclick="toggleFavorite('지평', this)">♡</span>
        </div>
        <img src="지평역.jpg" alt="지평역" class="station-img">
        <div class="rating">평균 평점: <span id="rate-지평">0.0</span></div>
      </div>
    </div>

    <div id="emptyMessage" class="empty">
      아직 즐겨찾는 역이 없습니다.<br>
      하트 버튼을 클릭해 주세요.
    </div>
  </div>

  <script>
    const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    const reviews   = JSON.parse(localStorage.getItem('reviews'))   || {};

    document.addEventListener('DOMContentLoaded', updateFavorites);

    function toggleFavorite(name, el) {
      const idx = favorites.indexOf(name);
      if (idx > -1) {
        favorites.splice(idx,1);
        el.classList.remove('active');
      } else {
        favorites.push(name);
        el.classList.add('active');
      }
      localStorage.setItem('favorites', JSON.stringify(favorites));
      updateFavorites();

      // 사진 토글
      const img = el.closest('.card').querySelector('.station-img');
      img.style.display = el.classList.contains('active') ? 'block' : 'none';
    }

    function updateFavorites() {
      let any=false;
      document.querySelectorAll('.card').forEach(card=>{
        const name = card.dataset.station;
        const heart = card.querySelector('.heart');
        const rateEl = card.querySelector('.rating span');
        const img = card.querySelector('.station-img');

        if (favorites.includes(name)) {
          card.style.display   = '';
          heart.classList.add('active');
          heart.textContent    = '♥';
          img.style.display    = 'block';
          any=true;
        } else {
          card.style.display   = 'none';
          heart.classList.remove('active');
          heart.textContent    = '♡';
          img.style.display    = 'none';
        }

        // 평점 표시
        const arr = reviews[name] || [];
        rateEl.textContent = arr.length
          ? (arr.reduce((a,b)=>a+b,0)/arr.length).toFixed(1)
          : '0.0';
      });
      document.getElementById('emptyMessage').style.display = any ? 'none' : '';
    }

    document.getElementById('searchInput').addEventListener('input', function() {
  const term = this.value.trim().toLowerCase();
  const cards = document.querySelectorAll('.card');
  if (term === '') {
    // 검색어가 없으면 즐겨찾기만 표시
    cards.forEach(card => {
      const name = card.dataset.station;
      const heart = card.querySelector('.heart');
      const img = card.querySelector('.station-img');
      if (favorites.includes(name)) {
        card.style.display = '';
        heart.classList.add('active');
        heart.textContent = '♥';
        img.style.display = 'block';
      } else {
        card.style.display = 'none';
        heart.classList.remove('active');
        heart.textContent = '♡';
        img.style.display = 'none';
      }
    });
  } else {
    // 검색어가 있으면 모든 역 중에서 검색어 포함된 역만 표시
    cards.forEach(card => {
      const name = card.dataset.station;
      const nameKor = card.querySelector('.header span').textContent.toLowerCase();
      const heart = card.querySelector('.heart');
      const img = card.querySelector('.station-img');
      if (name.toLowerCase().includes(term) || nameKor.includes(term)) {
        card.style.display = '';
        if (favorites.includes(name)) {
          heart.classList.add('active');
          heart.textContent = '♥';
          img.style.display = 'block';
        } else {
          heart.classList.remove('active');
          heart.textContent = '♡';
          img.style.display = 'none';
        }
      } else {
        card.style.display = 'none';
      }
    });
  }
  // 빈 상태 안내문구 처리
  const anyVisible = Array.from(document.querySelectorAll('.card')).some(card => card.style.display !== 'none');
  document.getElementById('emptyMessage').style.display = anyVisible ? 'none' : '';
});

  </script>
</div>
</body>
</html>
